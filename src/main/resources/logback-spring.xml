<configuration>
    <!-- 기본 설정을 포함 -->
    <include resource="org/springframework/boot/logging/logback/base.xml" />

    <!-- 추가: test login  -->
    <appender name="TEST_FILE" class="ch.qos.logback.core.FileAppender">
        <file>./log/test_log.json</file>
        <append>true</append>
        <encoder class="ch.qos.logback.core.encoder.LayoutWrappingEncoder">
            <layout class="ch.qos.logback.classic.PatternLayout">
                <pattern>%msg%n</pattern>
            </layout>
        </encoder>
    </appender>

    <!-- error level의 log가 저장된다. -->
    <logger name="com.example.frontServer.testFileSaveLogger" level="ERROR" additivity="false">
        <appender-ref ref="TEST_FILE" />
    </logger>

    <!-- 파일 경로 설정: root 프로젝트의 log/board/save/ -->
    <property name="BOARD_SAVE_LOG_PATH" value="${LOG_HOME:-./log}/board/save" />
    <!-- 날짜별 롤링 파일 명칭 -->
    <property name="BOARD_SAVE_LOG_FILE" value="${BOARD_SAVE_LOG_PATH}/board-save-%d{yyyy-MM-dd}.json" />

    <!-- JSON 로깅을 위한 dependency: net.logstash.logback:logstash-logback-encoder -->
    <appender name="BOARD_JSON" class="ch.qos.logback.core.rolling.RollingFileAppender">
        <file>${BOARD_SAVE_LOG_PATH}/board-save-current.json</file>
        <rollingPolicy class="ch.qos.logback.core.rolling.TimeBasedRollingPolicy">
            <fileNamePattern>${BOARD_SAVE_LOG_FILE}.gz</fileNamePattern>
            <maxHistory>30</maxHistory>
        </rollingPolicy>
        <encoder class="net.logstash.logback.encoder.LogstashEncoder">
            <!-- 추가 필드 삽입: 예를 들어 service명, 작성자 아이디 등 MDC에서 전달 -->
            <customFields>{"service":"frontServer", "logType":"board-save"}</customFields>
        </encoder>
    </appender>

    <!-- 게시글 저장 관련 로거 지정 (패키지 또는 클래스 단위) -->
    <logger name="com.example.frontServer.service.board.BoardService" level="INFO" additivity="false">
        <appender-ref ref="BOARD_JSON" />
    </logger>

    <!-- 기본 콘솔 로그 등 다른 로깅은 기본 설정 사용 -->
    <root level="INFO">
        <appender-ref ref="CONSOLE" />
    </root>

    <!-- 추가 설정이 필요한 경우 여기에 계속 작성 -->
</configuration>